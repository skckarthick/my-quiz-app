<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assistant Registrar NITK Exam Practice Quiz</title>
    <style>
        :root {
            --primary: #1e3a8a; --secondary: #2563eb; --accent: #3b82f6; --dark-bg: #0f172a;
            --darker-bg: #0c1322; --card-bg: #1e293b; --text: #e2e8f0; --correct: #10b981;
            --incorrect: #ef4444; --highlight: #60a5fa; --loading: #93c5fd;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: linear-gradient(135deg, var(--dark-bg), var(--darker-bg)); color: var(--text); min-height: 100vh; padding: 20px; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; }
        header { text-align: center; padding: 20px 0; border-bottom: 1px solid var(--accent); margin-bottom: 30px; }
        header h1 { font-size: 2.5rem; margin-bottom: 10px; color: var(--highlight); text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
        header p { font-size: 1.1rem; opacity: 0.9; max-width: 700px; margin: 0 auto; }
        .tabs { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-bottom: 30px; }
        .tab-btn { background: var(--card-bg); border: none; color: var(--text); padding: 12px 20px; border-radius: 8px; cursor: pointer; font-size: 1rem; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .tab-btn:hover { background: var(--secondary); transform: translateY(-2px); }
        .tab-btn.active { background: var(--secondary); box-shadow: 0 0 15px rgba(59, 130, 246, 0.5); }
        .quiz-container { background: var(--card-bg); border-radius: 12px; padding: 30px; box-shadow: 0 10px 25px rgba(0,0,0,0.3); margin-bottom: 30px; }
        .section-header { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 2px solid var(--accent); gap: 20px;}
        .section-header h2 { font-size: 1.8rem; color: var(--highlight); }
        .progress-container { display: flex; flex-wrap: wrap; align-items: center; gap: 15px; }
        .progress-bar { width: 200px; height: 12px; background: rgba(255,255,255,0.1); border-radius: 10px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--secondary); border-radius: 10px; transition: width 0.5s ease; }
        .question-container { margin-bottom: 30px; min-height: 250px; }
        .question-text { font-size: 1.4rem; margin-bottom: 25px; line-height: 1.5; background: rgba(255,255,255,0.05); padding: 20px; border-radius: 10px; border-left: 4px solid var(--accent); }
        .options-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .option { background: rgba(255,255,255,0.07); padding: 15px; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; font-size: 1.1rem; }
        .option.disabled { cursor: not-allowed; opacity: 0.6; }
        .option:not(.disabled):hover { background: rgba(255,255,255,0.12); border-color: var(--accent); }
        .option.selected { border-color: var(--secondary); background: rgba(37, 99, 235, 0.15); }
        .option.correct { background: rgba(16, 185, 129, 0.2); border-color: var(--correct); }
        .option.incorrect { background: rgba(239, 68, 68, 0.2); border-color: var(--incorrect); }
        .feedback-container { padding: 20px; border-radius: 10px; margin-top: 20px; background: rgba(255,255,255,0.05); border-left: 4px solid var(--accent); display: none; }
        .feedback-container.show { display: block; animation: fadeIn 0.5s ease; }
        .feedback-title { font-weight: bold; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .feedback-title.correct { color: var(--correct); }
        .feedback-title.incorrect { color: var(--incorrect); }
        .explanation { font-size: 1.1rem; line-height: 1.6; }
        .navigation { display: flex; justify-content: space-between; margin-top: 30px; gap: 15px; }
        .nav-btn { background: var(--secondary); color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; font-size: 1.1rem; font-weight: 600; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px; }
        .nav-btn:disabled { background: rgba(59, 130, 246, 0.3); cursor: not-allowed; }
        .nav-btn:hover:not(:disabled) { background: var(--accent); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .reset-btn { background: rgba(239, 68, 68, 0.2); color: var(--incorrect); }
        .reset-btn:hover:not(:disabled) { background: rgba(239, 68, 68, 0.3); }
        .stats { display: flex; justify-content: center; gap: 20px; margin-top: 20px; flex-wrap: wrap; }
        .stat-box { background: var(--card-bg); padding: 15px 25px; border-radius: 10px; text-align: center; min-width: 150px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        .stat-value { font-size: 2rem; font-weight: bold; margin: 10px 0; color: var(--highlight); }
        .stat-label { opacity: 0.8; }
        .loader { font-size: 1.2rem; text-align: center; padding: 40px; color: var(--loading); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- NEW STYLES FOR JUMP-TO FEATURE --- */
        .jump-to-wrapper { display: flex; align-items: center; gap: 10px; }
        #jump-to-input {
            width: 80px;
            padding: 5px 8px;
            background-color: var(--dark-bg);
            border: 1px solid var(--accent);
            color: var(--text);
            border-radius: 5px;
            text-align: center;
            font-size: 1rem;
        }
        #jump-to-input::placeholder { color: #64748b; }
        #jump-to-input:focus { outline: 1px solid var(--highlight); box-shadow: 0 0 5px var(--highlight); }
        /* Hide number input arrows */
        #jump-to-input { -moz-appearance: textfield; }
        #jump-to-input::-webkit-outer-spin-button, #jump-to-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        #jump-to-btn {
            padding: 5px 15px;
            font-size: 1rem;
            font-weight: 500;
            background: var(--accent);
        }
        #jump-to-btn:hover:not(:disabled) { background: var(--secondary); }

    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Assistant Registrar NITK Exam Practice Quiz</h1>
            <p>Comprehensive preparation tool with unique question banks for each syllabus section.</p>
        </header>
        
        <div class="tabs">
            <button class="tab-btn active" data-section="quantitative">Quantitative</button>
            <button class="tab-btn" data-section="verbal">Verbal</button>
            <button class="tab-btn" data-section="logical">Logical</button>
            <button class="tab-btn" data-section="general_awareness">General Awareness</button>
            <button class="tab-btn" data-section="current_affairs">Current Affairs</button>
            <button class="tab-btn" data-section="domain1">Domain 1</button>
            <button class="tab-btn" data-section="domain2">Domain 2</button>
            <button class="tab-btn" data-section="domain3">Domain 3</button>
        </div>
        
        <div class="quiz-container">
            <div class="section-header">
                <h2><span id="section-title">Loading...</span></h2>
                <div class="progress-container">
                    <!-- --- START OF HTML CHANGES --- -->
                    <div class="jump-to-wrapper">
                        <span id="progress-text">Question 0 of 0</span>
                        <input type="number" id="jump-to-input" placeholder="Go to..." min="1">
                        <button class="nav-btn" id="jump-to-btn">Go</button>
                    </div>
                    <!-- --- END OF HTML CHANGES --- -->
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            
            <div class="question-container" id="question-container">
                <!-- Content will be loaded dynamically -->
            </div>
            
            <div class="navigation">
                <button class="nav-btn" id="prev-btn" disabled>← Previous</button>
                <button class="nav-btn reset-btn" id="reset-btn" disabled>Reset Section</button>
                <button class="nav-btn" id="next-btn" disabled>Next →</button>
            </div>
            
            <div class="stats">
                <div class="stat-box"><div class="stat-label">Total Questions</div><div class="stat-value" id="total-questions">0</div></div>
                <div class="stat-box"><div class="stat-label">Answered</div><div class="stat-value" id="answered">0</div></div>
                <div class="stat-box"><div class="stat-label">Correct</div><div class="stat-value" id="correct">0</div></div>
                <div class="stat-box"><div class="stat-label">Accuracy</div><div class="stat-value" id="accuracy">0%</div></div>
            </div>
        </div>
        
        <footer>
            <p><strong>Important:</strong> This application may require a local web server (like VS Code's "Live Server") to run correctly.</p>
        </footer>
    </div>

    <script>
        // Quiz data and state management
        const quizData = {};
        const state = {
            currentSection: "quantitative",
            currentQuestionIndex: 0,
            sectionStates: {}
        };

        // DOM Elements
        const sectionTitleEl = document.getElementById("section-title");
        const questionContainerEl = document.getElementById("question-container");
        const prevBtn = document.getElementById("prev-btn");
        const nextBtn = document.getElementById("next-btn");
        const resetBtn = document.getElementById("reset-btn");
        const progressTextEl = document.getElementById("progress-text");
        const progressFillEl = document.getElementById("progress-fill");
        const totalQuestionsEl = document.getElementById("total-questions");
        const answeredEl = document.getElementById("answered");
        const correctEl = document.getElementById("correct");
        const accuracyEl = document.getElementById("accuracy");
        const tabButtons = document.querySelectorAll(".tab-btn");
        
        // --- NEW DOM ELEMENTS FOR JUMP-TO FEATURE ---
        const jumpToInput = document.getElementById('jump-to-input');
        const jumpToBtn = document.getElementById('jump-to-btn');

        function showLoader(message) {
            questionContainerEl.innerHTML = `<div class="loader">${message}</div>`;
            prevBtn.disabled = true;
            nextBtn.disabled = true;
            resetBtn.disabled = true;
            jumpToBtn.disabled = true;
            jumpToInput.disabled = true;
        }

        async function loadSection(sectionKey) {
            tabButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.section === sectionKey));
            state.currentSection = sectionKey;
            state.currentQuestionIndex = 0;

            showLoader(`Loading ${sectionKey.replace('_', ' ')} questions...`);

            if (quizData[sectionKey]) {
                initializeSection();
                return;
            }

            try {
                const response = await fetch(`./questions/${sectionKey}.json`);
                if (!response.ok) throw new Error(`File not found: ${sectionKey}.json`);
                const questions = await response.json();
                quizData[sectionKey] = questions;
                initializeSection();
            } catch (error) {
                console.error('Error loading question data:', error);
                showLoader(`Error: ${error.message}`);
            }
        }

        function initializeSection() {
            const sectionKey = state.currentSection;
            if (!state.sectionStates[sectionKey]) {
                state.sectionStates[sectionKey] = {
                    userAnswers: Array(quizData[sectionKey].length).fill(null),
                    answeredCount: 0,
                    correctCount: 0,
                };
            }
            const sectionTitle = sectionKey.split('_').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
            sectionTitleEl.textContent = sectionTitle;
            resetBtn.disabled = false;
            jumpToBtn.disabled = false;
            jumpToInput.disabled = false;
            displayQuestion();
        }

        function displayQuestion() {
            const sectionKey = state.currentSection;
            const questionIndex = state.currentQuestionIndex;
            const currentQuestion = quizData[sectionKey][questionIndex];
            const sectionState = state.sectionStates[sectionKey];
            const userAnswer = sectionState.userAnswers[questionIndex];
            const hasAnswered = userAnswer !== null;

            let optionsHTML = '';
            currentQuestion.options.forEach((option, index) => {
                let optionClass = 'option';
                if (hasAnswered) {
                    optionClass += ' disabled';
                    if (index === currentQuestion.correctAnswer) optionClass += ' correct';
                    if (index === userAnswer) optionClass += ' selected';
                    if (index === userAnswer && index !== currentQuestion.correctAnswer) optionClass += ' incorrect';
                }
                optionsHTML += `<div class="${optionClass}" data-index="${index}">${option}</div>`;
            });

            const feedbackHTML = hasAnswered ? `
                <div class="feedback-container show">
                    <div class="feedback-title ${userAnswer === currentQuestion.correctAnswer ? 'correct' : 'incorrect'}">
                        ${userAnswer === currentQuestion.correctAnswer ? 'Correct!' : 'Incorrect!'}
                    </div>
                    <div class="explanation">${currentQuestion.explanation}</div>
                </div>` : '<div class="feedback-container"></div>';

            questionContainerEl.innerHTML = `
                <div class="question-text">Q${questionIndex + 1}: ${currentQuestion.question}</div>
                <div class="options-container">${optionsHTML}</div>
                ${feedbackHTML}`;
            
            if (!hasAnswered) {
                document.querySelectorAll('.option').forEach(opt => {
                    opt.addEventListener('click', (e) => selectOption(parseInt(e.target.dataset.index)));
                });
            }

            updateNavigationAndStats();
        }

        function selectOption(optionIndex) {
            const sectionKey = state.currentSection;
            const questionIndex = state.currentQuestionIndex;
            const sectionState = state.sectionStates[sectionKey];
            if (sectionState.userAnswers[questionIndex] !== null) return;
            sectionState.userAnswers[questionIndex] = optionIndex;
            sectionState.answeredCount++;
            if (optionIndex === quizData[sectionKey][questionIndex].correctAnswer) {
                sectionState.correctCount++;
            }
            displayQuestion();
        }

        function updateNavigationAndStats() {
            const sectionKey = state.currentSection;
            const questions = quizData[sectionKey];
            const sectionState = state.sectionStates[sectionKey];
            
            prevBtn.disabled = state.currentQuestionIndex === 0;
            nextBtn.disabled = state.currentQuestionIndex === questions.length - 1;
            
            const progress = ((state.currentQuestionIndex + 1) / questions.length) * 100;
            progressTextEl.textContent = `Question ${state.currentQuestionIndex + 1} of ${questions.length}`;
            progressFillEl.style.width = `${progress}%`;

            totalQuestionsEl.textContent = questions.length;
            answeredEl.textContent = sectionState.answeredCount;
            correctEl.textContent = sectionState.correctCount;
            const accuracy = sectionState.answeredCount > 0 ? Math.round((sectionState.correctCount / sectionState.answeredCount) * 100) : 0;
            accuracyEl.textContent = `${accuracy}%`;

            // Update placeholder for the jump-to input
            jumpToInput.placeholder = `1-${questions.length}`;
            jumpToInput.max = questions.length;
        }
        
        function resetCurrentSection() {
            const sectionKey = state.currentSection;
            if(quizData[sectionKey]) {
                state.sectionStates[sectionKey] = {
                    userAnswers: Array(quizData[sectionKey].length).fill(null),
                    answeredCount: 0,
                    correctCount: 0,
                };
                state.currentQuestionIndex = 0;
                displayQuestion();
            }
        }

        // --- NEW JUMP-TO QUESTION FUNCTION ---
        function jumpToQuestion() {
            const sectionKey = state.currentSection;
            const totalQuestions = quizData[sectionKey].length;
            const targetQuestionNum = parseInt(jumpToInput.value);

            if (isNaN(targetQuestionNum) || targetQuestionNum < 1 || targetQuestionNum > totalQuestions) {
                alert(`Please enter a valid question number between 1 and ${totalQuestions}.`);
                jumpToInput.value = '';
                return;
            }

            // Set the state to the new question index (remembering that array indexes are 0-based)
            state.currentQuestionIndex = targetQuestionNum - 1;
            
            // Clear the input field
            jumpToInput.value = '';

            // Re-render the display for the new question
            displayQuestion();
        }

        // Event Listeners
        prevBtn.addEventListener('click', () => {
            if (state.currentQuestionIndex > 0) {
                state.currentQuestionIndex--;
                displayQuestion();
            }
        });

        nextBtn.addEventListener('click', () => {
            const sectionKey = state.currentSection;
            if (state.currentQuestionIndex < quizData[sectionKey].length - 1) {
                state.currentQuestionIndex++;
                displayQuestion();
            }
        });

        resetBtn.addEventListener('click', resetCurrentSection);

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                loadSection(button.dataset.section);
            });
        });
        
        // --- NEW EVENT LISTENERS FOR JUMP-TO FEATURE ---
        jumpToBtn.addEventListener('click', jumpToQuestion);
        jumpToInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault(); // Prevent form submission if it's in a form
                jumpToQuestion();
            }
        });


        // Initial Load
        window.addEventListener('DOMContentLoaded', () => loadSection('quantitative'));
    </script>
</body>
</html>