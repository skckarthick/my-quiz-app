<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assistant Registrar Exam Prep Pro</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0d1117;
            --card-bg: rgba(22, 27, 34, 0.6);
            --border-color: rgba(255, 255, 255, 0.1);
            --text-primary: #e6edf3;
            --text-secondary: #7d8590;
            --accent-primary: #58a6ff;
            --accent-secondary: #3fb950;
            --accent-error: #f85149;
            --shadow-color: rgba(0, 0, 0, 0.4);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: radial-gradient(circle at 15% 25%, rgba(88, 166, 255, 0.15), transparent 40%),
                        radial-gradient(circle at 85% 75%, rgba(63, 185, 80, 0.15), transparent 40%);
            animation: background-glow 15s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes background-glow {
            0% { transform: scale(1) rotate(0deg); opacity: 0.8; }
            50% { transform: scale(1.2) rotate(10deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); opacity: 0.8; }
        }

        .container { max-width: 900px; margin: 20px auto; }

        header { text-align: center; margin-bottom: 40px; }
        header h1 { font-size: clamp(2rem, 5vw, 2.5rem); font-weight: 700; margin-bottom: 10px; }
        header p { color: var(--text-secondary); font-size: 1.1rem; }

        .tabs { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-bottom: 40px; }
        .tab-btn {
            background: none; border: 1px solid var(--border-color); color: var(--text-secondary);
            padding: 10px 20px; border-radius: 20px; cursor: pointer; font-size: 0.9rem;
            font-weight: 600; transition: all 0.3s ease;
        }
        .tab-btn:hover { color: var(--text-primary); border-color: var(--accent-primary); }
        .tab-btn.active { color: var(--text-primary); background-color: var(--accent-primary); border-color: var(--accent-primary); }

        .quiz-container {
            background: var(--card-bg);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 32px 0 var(--shadow-color);
            margin-bottom: 30px;
        }

        .section-header {
            display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center;
            margin-bottom: 25px; padding-bottom: 20px; border-bottom: 1px solid var(--border-color); gap: 20px;
        }
        .section-header h2 { font-size: 1.5rem; font-weight: 600; }
        .progress-wrapper { display: flex; align-items: center; gap: 15px; flex-wrap: wrap; }
        #progress-text { font-size: 0.9rem; color: var(--text-secondary); }
        .progress-bar { width: 150px; height: 8px; background: rgba(0,0,0,0.3); border-radius: 8px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--accent-primary); border-radius: 8px; transition: width 0.5s ease; }
        
        .question-text { font-size: clamp(1.2rem, 3vw, 1.4rem); margin: 30px 0; font-weight: 500; }
        
        .options-container { display: flex; flex-direction: column; gap: 15px; }
        .option {
            position: relative; /* Needed for sparkle effect */
            display: flex; align-items: center; gap: 15px;
            background: rgba(255, 255, 255, 0.05); border: 1px solid var(--border-color);
            padding: 15px; border-radius: 12px; cursor: pointer;
            transition: all 0.2s ease-in-out;
            overflow: hidden;
        }
        .option:hover:not(.disabled) { transform: translateY(-3px); border-color: var(--accent-primary); }
        .option-prefix {
            flex-shrink: 0; width: 30px; height: 30px;
            display: grid; place-items: center;
            border: 1px solid var(--text-secondary); border-radius: 50%;
            font-weight: 600; color: var(--text-secondary); transition: all 0.2s ease-in-out; z-index: 2;
        }
        .option-text { flex-grow: 1; z-index: 2; }
        .feedback-icon { font-size: 1.5rem; opacity: 0; transform: scale(0.5); transition: all 0.3s ease; z-index: 2;}
        
        .option.disabled { cursor: not-allowed; }
        .option.selected { border-color: var(--accent-primary); }
        .option.selected .option-prefix { border-color: var(--accent-primary); color: var(--text-primary); background-color: var(--accent-primary); }
        .option.correct.selected { border-color: var(--accent-secondary); animation: pop 0.3s ease-out; }
        .option.correct.selected .option-prefix { background-color: var(--accent-secondary); border-color: var(--accent-secondary); }
        .option.correct .feedback-icon { color: var(--accent-secondary); opacity: 1; transform: scale(1); }
        .option.incorrect.selected { border-color: var(--accent-error); animation: shake 0.5s ease; }
        .option.incorrect.selected .option-prefix { background-color: var(--accent-error); border-color: var(--accent-error); }
        .option.incorrect .feedback-icon { color: var(--accent-error); opacity: 1; transform: scale(1); }

        .explanation {
            margin-top: 20px; padding: 15px;
            background: rgba(0,0,0,0.2); border-radius: 8px;
            border-left: 3px solid var(--accent-primary);
            font-size: 0.95rem; color: var(--text-secondary);
            display: none;
        }
        .explanation.show { display: block; animation: fadeIn 0.5s ease; }

        .navigation { display: flex; justify-content: space-between; align-items: center; margin-top: 30px; gap: 15px; flex-wrap: wrap; }
        .nav-btn {
            background: var(--accent-primary); color: white; border: none;
            padding: 12px 25px; border-radius: 8px; cursor: pointer;
            font-size: 1rem; font-weight: 600; transition: all 0.3s ease;
        }
        .nav-btn:disabled { background: var(--text-secondary); cursor: not-allowed; opacity: 0.5; }
        .nav-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(88, 166, 255, 0.3); }
        .reset-btn { background: rgba(248, 81, 73, 0.2); color: var(--accent-error); }
        .reset-btn:hover:not(:disabled) { background: rgba(248, 81, 73, 0.4); box-shadow: none; }
        .jump-to-wrapper { display: flex; align-items: center; gap: 10px; }
        #jump-to-input { width: 70px; padding: 8px; background-color: var(--card-bg); border: 1px solid var(--border-color); color: var(--text-primary); border-radius: 8px; text-align: center; }
        #jump-to-btn { padding: 8px 15px; font-size: 0.9rem; }
        
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; text-align: center; margin-top: 40px; }
        .stat-box { background: var(--card-bg); backdrop-filter: blur(10px); border: 1px solid var(--border-color); padding: 20px; border-radius: 12px; }
        .stat-label { color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 10px; }
        .stat-value { font-size: 2rem; font-weight: 700; color: var(--text-primary); }
        
        .loader { font-size: 1.2rem; text-align: center; padding: 40px; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes pop { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); } 20%, 40%, 60%, 80% { transform: translateX(5px); } }

        /* Sparkle animation for correct answers */
        .sparkle { position: absolute; width: 6px; height: 6px; background: #fff; border-radius: 50%; z-index: 1; animation: sparkle-anim 0.8s forwards; }
        @keyframes sparkle-anim {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.5) translate(var(--tx), var(--ty)); opacity: 0; }
        }

    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Assistant Registrar Prep Pro</h1>
            <p>A comprehensive and modern quiz tool for exam success.</p>
        </header>
        
        <div class="tabs">
            <button class="tab-btn active" data-section="quantitative">Quantitative</button>
            <button class="tab-btn" data-section="verbal">Verbal</button>
            <button class="tab-btn" data-section="logical">Logical</button>
            <button class="tab-btn" data-section="general_awareness">Awareness</button>
            <button class="tab-btn" data-section="current_affairs">Current Affairs</button>
            <button class="tab-btn" data-section="domain1">Domain 1</button>
            <button class="tab-btn" data-section="domain2">Domain 2</button>
            <button class="tab-btn" data-section="domain3">Domain 3</button>
        </div>
        
        <div class="quiz-container">
            <div class="section-header">
                <h2 id="section-title">Loading...</h2>
                <div class="progress-wrapper">
                    <div class="jump-to-wrapper">
                        <input type="number" id="jump-to-input" placeholder="Go to..." min="1">
                        <button class="nav-btn" id="jump-to-btn">Go</button>
                    </div>
                </div>
            </div>

            <div id="question-area">
                 <!-- Content will be loaded dynamically -->
            </div>
            
            <div class="navigation">
                <button class="nav-btn" id="prev-btn" disabled>Previous</button>
                <span id="progress-text">Question 0 of 0</span>
                <button class="nav-btn" id="next-btn" disabled>Next</button>
            </div>
        </div>

        <div class="stats">
            <div class="stat-box"><div class="stat-label">Total Questions</div><div class="stat-value" id="total-questions">0</div></div>
            <div class="stat-box"><div class="stat-label">Answered</div><div class="stat-value" id="answered">0</div></div>
            <div class="stat-box"><div class="stat-label">Correct</div><div class="stat-value" id="correct">0</div></div>
            <div class="stat-box"><div class="stat-label">Accuracy</div><div class="stat-value" id="accuracy">0%</div></div>
        </div>

        <div style="text-align: center; margin-top: 30px;">
             <button class="nav-btn reset-btn" id="reset-btn" disabled>Reset Current Section</button>
        </div>
        <footer style="text-align: center; margin-top: 40px; color: var(--text-secondary); font-size: 0.9rem;">
          <p> <marquee> Developer: <strong>Karthick S</strong> </marquee> </p>
        </footer>
    </div>

    <script>
        const quizData = {};
        const state = { currentSection: "quantitative", currentQuestionIndex: 0, sectionStates: {} };

        // DOM Elements
        const dom = {
            sectionTitle: document.getElementById("section-title"),
            questionArea: document.getElementById("question-area"),
            prevBtn: document.getElementById("prev-btn"),
            nextBtn: document.getElementById("next-btn"),
            resetBtn: document.getElementById("reset-btn"),
            progressText: document.getElementById("progress-text"),
            totalQuestions: document.getElementById("total-questions"),
            answered: document.getElementById("answered"),
            correct: document.getElementById("correct"),
            accuracy: document.getElementById("accuracy"),
            tabs: document.querySelectorAll(".tab-btn"),
            jumpInput: document.getElementById('jump-to-input'),
            jumpBtn: document.getElementById('jump-to-btn'),
        };
        
        function triggerSparkle(element) {
            for (let i = 0; i < 15; i++) {
                const sparkle = document.createElement('div');
                sparkle.classList.add('sparkle');
                const angle = Math.random() * 2 * Math.PI;
                const distance = Math.random() * 40 + 30;
                sparkle.style.setProperty('--tx', `${Math.cos(angle) * distance}px`);
                sparkle.style.setProperty('--ty', `${Math.sin(angle) * distance}px`);
                sparkle.style.top = '50%';
                sparkle.style.left = '50%';
                element.appendChild(sparkle);
                sparkle.addEventListener('animationend', () => sparkle.remove());
            }
        }

        function showLoader(message) {
            dom.questionArea.innerHTML = `<div class="loader">${message}</div>`;
            [dom.prevBtn, dom.nextBtn, dom.resetBtn, dom.jumpBtn, dom.jumpInput].forEach(el => el.disabled = true);
        }

        async function loadSection(sectionKey) {
            dom.tabs.forEach(btn => btn.classList.toggle('active', btn.dataset.section === sectionKey));
            state.currentSection = sectionKey;
            state.currentQuestionIndex = 0;
            showLoader(`Loading ${sectionKey.replace(/_/g, ' ')} questions...`);
            if (quizData[sectionKey]) {
                initializeSection();
                return;
            }
            try {
                const response = await fetch(`./questions/${sectionKey}.json`);
                if (!response.ok) throw new Error(`File not found: ${sectionKey}.json. Make sure the file exists in the 'questions' folder.`);
                quizData[sectionKey] = await response.json();
                initializeSection();
            } catch (error) {
                showLoader(`Error: ${error.message}`);
            }
        }

        function initializeSection() {
            const sectionKey = state.currentSection;
            if (!state.sectionStates[sectionKey]) {
                state.sectionStates[sectionKey] = {
                    userAnswers: Array(quizData[sectionKey].length).fill(null),
                    answeredCount: 0,
                    correctCount: 0,
                };
            }
            const sectionTitle = sectionKey.split('_').map(w => w[0].toUpperCase() + w.slice(1)).join(' ');
            dom.sectionTitle.textContent = sectionTitle;
            [dom.resetBtn, dom.jumpBtn, dom.jumpInput].forEach(el => el.disabled = false);
            displayQuestion();
        }

        function displayQuestion() {
            const sectionKey = state.currentSection;
            const qIndex = state.currentQuestionIndex;
            const currentQ = quizData[sectionKey][qIndex];
            const sectionState = state.sectionStates[sectionKey];
            const userAnswer = sectionState.userAnswers[qIndex];
            const hasAnswered = userAnswer !== null;
            const prefixes = ['A', 'B', 'C', 'D', 'E'];

            let optionsHTML = currentQ.options.map((option, index) => {
                let optionClass = 'option';
                let feedbackIcon = '';
                if (hasAnswered) {
                    optionClass += ' disabled';
                    if (index === userAnswer) optionClass += ' selected';
                    if (index === currentQ.correctAnswer) {
                        optionClass += ' correct';
                        feedbackIcon = '✓';
                    } else if (index === userAnswer) {
                        optionClass += ' incorrect';
                        feedbackIcon = '✗';
                    }
                }
                return `
                    <div class="${optionClass}" data-index="${index}">
                        <span class="option-prefix">${prefixes[index]}</span>
                        <span class="option-text">${option}</span>
                        <span class="feedback-icon">${feedbackIcon}</span>
                    </div>`;
            }).join('');
            
            const explanationHTML = hasAnswered ? `<div class="explanation show">${currentQ.explanation}</div>` : '';

            dom.questionArea.innerHTML = `
                <div class="question-text">${qIndex + 1}. ${currentQ.question}</div>
                <div class="options-container">${optionsHTML}</div>
                ${explanationHTML}`;

            if (!hasAnswered) {
                document.querySelectorAll('.option').forEach(opt => {
                    opt.addEventListener('click', e => selectOption(parseInt(e.currentTarget.dataset.index)));
                });
            } else {
                 const correctOptionEl = dom.questionArea.querySelector('.option.correct');
                 if(correctOptionEl && correctOptionEl.classList.contains('selected')) {
                    // This is a post-answer render, if it's the first time seeing this correct answer, sparkle it.
                    // This logic might need refinement to prevent re-sparkling on prev/next navigation.
                 }
            }
            updateUI();
        }

        function selectOption(optionIndex) {
            const sectionKey = state.currentSection;
            const qIndex = state.currentQuestionIndex;
            const sectionState = state.sectionStates[sectionKey];
            if (sectionState.userAnswers[qIndex] !== null) return;
            sectionState.userAnswers[qIndex] = optionIndex;
            sectionState.answeredCount++;
            const isCorrect = optionIndex === quizData[sectionKey][qIndex].correctAnswer;
            if (isCorrect) {
                sectionState.correctCount++;
            }
            displayQuestion();
             if (isCorrect) {
                const correctOptionEl = dom.questionArea.querySelector('.option.correct.selected');
                if (correctOptionEl) {
                    setTimeout(() => triggerSparkle(correctOptionEl), 100);
                }
            }
        }

        function updateUI() {
            const sectionKey = state.currentSection;
            const questions = quizData[sectionKey];
            const sectionState = state.sectionStates[sectionKey];
            
            dom.prevBtn.disabled = state.currentQuestionIndex === 0;
            dom.nextBtn.disabled = state.currentQuestionIndex === questions.length - 1;
            
            dom.progressText.textContent = `Question ${state.currentQuestionIndex + 1} of ${questions.length}`;
            
            dom.totalQuestions.textContent = questions.length;
            dom.answered.textContent = sectionState.answeredCount;
            dom.correct.textContent = sectionState.correctCount;
            dom.accuracy.textContent = `${sectionState.answeredCount > 0 ? Math.round((sectionState.correctCount / sectionState.answeredCount) * 100) : 0}%`;
            
            dom.jumpInput.placeholder = `1-${questions.length}`;
            dom.jumpInput.max = questions.length;
        }
        
        function resetCurrentSection() {
            const sectionKey = state.currentSection;
            if (quizData[sectionKey]) {
                state.sectionStates[sectionKey] = { userAnswers: Array(quizData[sectionKey].length).fill(null), answeredCount: 0, correctCount: 0 };
                state.currentQuestionIndex = 0;
                displayQuestion();
            }
        }

        function jumpToQuestion() {
            const total = quizData[state.currentSection].length;
            const target = parseInt(dom.jumpInput.value);
            if (!isNaN(target) && target >= 1 && target <= total) {
                state.currentQuestionIndex = target - 1;
                dom.jumpInput.value = '';
                displayQuestion();
            } else {
                alert(`Please enter a valid number between 1 and ${total}.`);
                dom.jumpInput.value = '';
            }
        }

        // Event Listeners
        dom.prevBtn.addEventListener('click', () => { if (state.currentQuestionIndex > 0) { state.currentQuestionIndex--; displayQuestion(); } });
        dom.nextBtn.addEventListener('click', () => { if (state.currentQuestionIndex < quizData[state.currentSection].length - 1) { state.currentQuestionIndex++; displayQuestion(); } });
        dom.resetBtn.addEventListener('click', resetCurrentSection);
        dom.tabs.forEach(btn => btn.addEventListener('click', () => loadSection(btn.dataset.section)));
        dom.jumpBtn.addEventListener('click', jumpToQuestion);
        dom.jumpInput.addEventListener('keydown', e => { if (e.key === 'Enter') { e.preventDefault(); jumpToQuestion(); } });

        // Initial Load
        window.addEventListener('DOMContentLoaded', () => loadSection('quantitative'));
    </script>
</body>
</html>
